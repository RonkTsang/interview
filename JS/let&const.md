# `let` & `const`

- [`let` & `const`](#let-const)
  - [`let`](#let)
    - [**ä½œç”¨åŸŸ**ï¼šåªåœ¨**å½“å‰ä»£ç å—**æœ‰æ•ˆ](#%E4%BD%9C%E7%94%A8%E5%9F%9F%EF%BC%9A%E5%8F%AA%E5%9C%A8%E5%BD%93%E5%89%8D%E4%BB%A3%E7%A0%81%E5%9D%97%E6%9C%89%E6%95%88)
      - [å…³äº `for` å¾ªç¯](#%E5%85%B3%E4%BA%8E-for-%E5%BE%AA%E7%8E%AF)
    - [**ä¸å­˜åœ¨å˜é‡æå‡**](#%E4%B8%8D%E5%AD%98%E5%9C%A8%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87)
    - [**ä¸å…è®¸é‡å¤å£°æ˜**](#%E4%B8%8D%E5%85%81%E8%AE%B8%E9%87%8D%E5%A4%8D%E5%A3%B0%E6%98%8E)
    - [**`let` å®é™…ä¸Šä¸º JavaScript æ–°å¢äº†å—çº§ä½œç”¨åŸŸ**](#let-%E5%AE%9E%E9%99%85%E4%B8%8A%E4%B8%BA-javascript-%E6%96%B0%E5%A2%9E%E4%BA%86%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F)
  - [`const`](#const)
  - [æš‚æ—¶æ€§æ­»åŒº](#%E6%9A%82%E6%97%B6%E6%80%A7%E6%AD%BB%E5%8C%BA)
  - [å‚è€ƒ](#%E5%8F%82%E8%80%83)

---

## `let`

 ### **ä½œç”¨åŸŸ**ï¼šåªåœ¨**å½“å‰ä»£ç å—**æœ‰æ•ˆ

  ``` javascript

  for (let i = 0; i < 10; i++) {
    // ...
  }

  console.log(i) // // ReferenceError: i is not defined
  
  ```
  è®¡æ•°å™¨`i`åªåœ¨`for`å¾ªç¯ä½“å†…æœ‰æ•ˆï¼Œåœ¨å¾ªç¯ä½“å¤–å¼•ç”¨å°±ä¼šæŠ¥é”™.

  æ‰€ä»¥ `for` å¾ªç¯çš„è®¡æ•°å™¨ï¼Œå°±å¾ˆåˆé€‚ä½¿ç”¨ `let` å‘½ä»¤ã€‚

  ``` javascript

  // ä½¿ç”¨ var

  var a = [];
  for (var i = 0; i < 10; i++) {
    a[i] = function () {
      console.log(i);
    };
  }
  a[6](); // 10

  // ä½¿ç”¨ let
  
  var a = [];
  for (let i = 0; i < 10; i++) {
    a[i] = function () {
      console.log(i);
    };
  }
  a[6](); // 6
  
  ```
  å˜é‡`i`æ˜¯`let`å£°æ˜çš„ï¼Œå½“å‰çš„`i`åªåœ¨**æœ¬è½®å¾ªç¯**æœ‰æ•ˆï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯çš„`i`å…¶å®éƒ½æ˜¯ä¸€ä¸ªâ€œæ–°çš„å˜é‡â€ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçš„æ˜¯6ã€‚
  
  é‚£æ—¢ç„¶æ¯ä¸€è½®å¾ªç¯çš„å˜é‡iéƒ½æ˜¯é‡æ–°å£°æ˜çš„ï¼Œé‚£å®ƒæ€ä¹ˆçŸ¥é“ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œä»è€Œè®¡ç®—å‡ºæœ¬è½®å¾ªç¯çš„å€¼ï¼Ÿè¿™æ˜¯å› ä¸º JavaScript å¼•æ“å†…éƒ¨ä¼šè®°ä½ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œåˆå§‹åŒ–æœ¬è½®çš„å˜é‡ `i` æ—¶ï¼Œå°±åœ¨ä¸Šä¸€è½®å¾ªç¯çš„åŸºç¡€ä¸Šè¿›è¡Œè®¡ç®—ã€‚

  #### å…³äº `for` å¾ªç¯

  ``` javascript
  for (let i = 0; i < 3; i++) {
    let i = 'abc';
    console.log(i);
  }
  // æ‰“å° 3ä¸ª abc
  ```

  `for` å¾ªç¯ä¸€ä¸ªç‰¹åˆ«ä¹‹å¤„ï¼Œå°±æ˜¯è®¾ç½®å¾ªç¯å˜é‡çš„é‚£éƒ¨åˆ†æ˜¯ä¸€ä¸ª**çˆ¶ä½œç”¨åŸŸ**ï¼Œè€Œå¾ªç¯ä½“å†…éƒ¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„ **å­ä½œç”¨åŸŸ**

 ### **ä¸å­˜åœ¨å˜é‡æå‡**

  ``` javascript
  // var çš„æƒ…å†µ
  console.log(foo); // è¾“å‡ºundefined
  var foo = 2;

  // let çš„æƒ…å†µ
  console.log(bar); // æŠ¥é”™ReferenceError
  let bar = 2;
  ```

 ### **ä¸å…è®¸é‡å¤å£°æ˜**

  ``` javascript

  // æŠ¥é”™
  function func() {
    let a = 10;
    var a = 1;
  }

  // æŠ¥é”™
  function func() {
    let a = 10;
    let a = 1;
  }

  // æŠ¥é”™, ä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨é‡æ–°å£°æ˜å‚æ•°ã€‚
  function func(arg) {
    let arg; 
  }
  // ä¸æŠ¥é”™
  function func(arg) {
    {
      let arg; 
    }
  }
  ```

 ### **`let` å®é™…ä¸Šä¸º JavaScript æ–°å¢äº†å—çº§ä½œç”¨åŸŸ**

  ``` javascript
  // IIFE å†™æ³•
  (function () {
    var tmp = ...
  }());

  // å—çº§ä½œç”¨åŸŸå†™æ³•
  {
    let tmp = ...
  }
  ```

  å—çº§ä½œç”¨åŸŸä¸‹çš„å‡½æ•°å£°æ˜, **è¡Œä¸ºç±»ä¼¼äº `var` å£°æ˜çš„å˜é‡**

  ``` javascript
  // æµè§ˆå™¨çš„ ES6 ç¯å¢ƒ
  function f() { console.log('outside'); }

  (function () {
    if (false) {
      // é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•° f
      function f() { console.log('inside'); }
    }

    f();
  }());

  // Uncaught TypeError: f is not a function

  // åœ¨ä¸Šé¢çš„ç«‹å³æ‰§è¡Œå‡½æ•°ä¸­ï¼Œç›¸å½“äºï¼š

  var f = undefined;    // å³ f è¢«æå‡
  if (false) {
    function f() { console.log('I am inside!'); }
  }

  f();
  ```


---

## `const`

  > `const` å£°æ˜ä¸€ä¸ª**åªè¯»çš„å¸¸é‡**ã€‚ä¸€æ—¦å£°æ˜ï¼Œ**å¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜**

  ä½†æ˜¯!!!!ğŸ˜•

  `const` å®é™…ä¸Šä¿è¯çš„ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å€¼ä¸å¾—æ”¹åŠ¨ï¼Œè€Œæ˜¯**å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ä¸å¾—æ”¹åŠ¨**

  - ç®€å•ç±»å‹çš„æ•°æ®ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ï¼Œå€¼å°±ä¿å­˜åœ¨å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ç­‰åŒäºå¸¸é‡

  - å¯¹äºå¤åˆç±»å‹çš„æ•°æ®ï¼ˆä¸»è¦æ˜¯å¯¹è±¡å’Œæ•°ç»„ï¼‰ï¼Œå˜é‡æŒ‡å‘çš„**å†…å­˜åœ°å€**ï¼Œä¿å­˜çš„åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œ **const** åªèƒ½ä¿è¯è¿™ä¸ªæŒ‡é’ˆæ˜¯å›ºå®šçš„ï¼Œè‡³äºå®ƒæŒ‡å‘çš„æ•°æ®ç»“æ„æ˜¯ä¸æ˜¯å¯å˜çš„ï¼Œå°±å®Œå…¨ä¸èƒ½æ§åˆ¶äº†

  ``` javascript

  const foo = {};

  // ä¸º foo æ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥æˆåŠŸ
  foo.prop = 123;
  foo.prop // 123

  // å°† foo æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šæŠ¥é”™
  foo = {}; // TypeError: "foo" is read-only

  const a = [];
  a.push('Hello');  // å¯æ‰§è¡Œ
  a.length = 0;     // å¯æ‰§è¡Œ
  a = ['Dave'];     // æŠ¥é”™

  ```

  è‡³äºå¦‚ä½•å†»ç»“ä¸€ä¸ªå¯¹è±¡ï¼Œå¾€è¿™å„¿çœ‹ ğŸ‘‰[`Object.freeze` VS `Object.seal`](./freezeVSseal.md)

---

## æš‚æ—¶æ€§æ­»åŒº

  > ES6 æ˜ç¡®è§„å®šï¼Œå¦‚æœåŒºå—ä¸­å­˜åœ¨ `let` å’Œ `const` å‘½ä»¤ï¼Œè¿™ä¸ªåŒºå—å¯¹è¿™äº›å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä»ä¸€å¼€å§‹å°±å½¢æˆäº†**å°é—­ä½œç”¨åŸŸ**ã€‚**å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™**ã€‚è¿™åœ¨è¯­æ³•ä¸Šï¼Œç§°ä¸ºâ€œ**æš‚æ—¶æ€§æ­»åŒº**â€ï¼ˆtemporal dead zoneï¼Œç®€ç§° TDZï¼‰

  ``` javascript

  if (true) {
    // TDZå¼€å§‹
    tmp = 'abc'; // ReferenceError
    console.log(tmp); // ReferenceError

    let tmp; // TDZç»“æŸ
    console.log(tmp); // undefined
  }
  
  ```

  **â€œæš‚æ—¶æ€§æ­»åŒºâ€æ„å‘³ç€ `typeof` ä¸å†æ˜¯ä¸€ä¸ªç™¾åˆ†ä¹‹ç™¾å®‰å…¨çš„æ“ä½œ**ã€‚

  ``` javascript

  typeof undeclared_variable  // "undefined"
  
  typeof x                   // ReferenceError
  let x

  ```

  **é»˜è®¤å‚æ•°çš„â€œæ­»åŒºâ€**

  ``` javascript

  function bar(x = y, y = 2) {
    return [x, y];
  }

  bar(); // æŠ¥é”™
  
  ```

  å‚æ•° `x` é»˜è®¤å€¼ç­‰äºå¦ä¸€ä¸ªå‚æ•° `y` ï¼Œè€Œ**æ­¤æ—¶ `y` è¿˜æ²¡æœ‰å£°æ˜**ï¼Œå±äº æ­»åŒº

  ``` javascript
  function bar(x = 2, y = x) {
    return [x, y];
  }
  bar(); // [2, 2]
  ```

  è¿™ä¸ªæƒ…å†µï¼Œ`y` é»˜è®¤å€¼æ˜¯ `x`, è€Œæ­¤æ—¶ `x` å·²ç»å£°æ˜ï¼Œæ˜¯å®Œå…¨Oæ–‡æ˜Kçš„

---

## å‚è€ƒ

[let å’Œ const å‘½ä»¤](http://es6.ruanyifeng.com/#docs/let)